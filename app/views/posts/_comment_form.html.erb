<h3>
    Introduce un comentario:
</h3>


<%- # Este formulario envia al controlador de comments los siguientes parametros para crear un objeto tipo comment (aunque estamos en una vista perteneciente a posts form_for envia el formulario a la funciÃ³n create dentro del controlador de comments)): -%>
<%- # "comment"=>{"post_id"=>"1", "user_name"=>"juanito", "web_page"=>"pepito", "contenido"=>"una chorrada"}, "commit"=>"Post Comment"}  -%>

 <%- # Opciones para loguearse con otros servicios o para introducir comentario como usuario anonimo  -%>

 <div class = "providers_buttons">
    <% if signed_in? %>
        <%- # TODO: tambies es necesario un sign out, una vez estas logueado -%>
       <div class = "logged_with"> You are signed in with <%= current_user.authorization.provider %> (<%=link_to "Sign out", {:controller => 'sessions', :action => 'destroy'}, :method => :post %>), leave your answer below: </div>

    <% else %>
       <div class="autenticate_con"> Autenticate con:</div>
       <div class="provider_button"> <%= link_to image_tag("facebook_button.png", :width => "30x30"), '/auth/facebook' %></div>
       <div class="provider_button"> <%= link_to image_tag("twitter_button.png", :width => "30x30"), '/auth/twitter' %></div>
       <div class="provider_button"> <%= link_to image_tag("linkedin_button.png", :width => "30x30"), '/auth/linked_in' %></div>
    <% end %>

 </div>



<%= form_for(@comment, :remote => true, :html => {:id => "comment_form_#{post}"}) do |f| %>
    <% if @comment.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@comment.errors.count, "error") %> prohibited this comment from being saved:</h2>

          <ul>
            <% @comment.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
    <% end %>

    <%- # Gracias al parametro value le paso un valor concreto al hidden field.. de forma que va a recibir el parametro :post_id = una_id_de_un_post  -%>
    <%= f.hidden_field :post_id, :value => post %>

    <%- # TODO: caso en el que un usuario se autentica para dejar un comentario -%>
    <% if signed_in? %>
        <%= f.hidden_field :user_id, :value => current_user.id %>
    <% end %>

    <% if not signed_in? %>
        <div class="name_field">
          <%= f.label :name %>:&nbsp;&nbsp;
          <%= f.text_field :user_name %>
        </div>
    <% end %>

    <% if not signed_in? %>
        <div class="web_page_field">
          <%= f.label :web_page %>:&nbsp;&nbsp;
          <%= f.text_field :web_page %>
        </div>
    <% end %>

    <div class="comment_field">
      <%= f.text_area :contenido %>
    </div>

    <div class="submit_button">
      <%= f.submit "Post Comment" %>
    </div>

<% end %>